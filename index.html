<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ν•™κ³Ό ν† λ΅ λ°©</title>
  <link rel="stylesheet" href="style.css">
  <script type="module" src="https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js"></script>
  <script type="module" src="https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js"></script>
  <script type="module" src="/firebase-init.js"></script>
</head>

<body>
  <header class="main-header">
    <h1>ν•™κ³Ό ν† λ΅ λ°©</h1>
    <nav class="main-nav">
      <ul></ul>
    </nav>
  </header>

  <main class="main-content">
    <section class="popular-posts">
      <h2>π”¥λ­ν‚Ή TOP 5</h2>
      <ul id="popular-posts-list">
      </ul>
      <button id="view-more-popular" class="popular-btn">μΈκΈ°κΈ€ λ”λ³΄κΈ°</button>
    </section>

    <section class="departments">
      <ul>
        <div class="departments2">
          <h2>γ„±</h2>
          <li><a href="department_discussion.html?dept=κ°„νΈν•™κ³Ό">κ°„νΈν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κ²μ„κ³µν•™κ³Ό">κ²μ„κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κ²½κΈ°μ§€λ„ν•™κ³Ό">κ²½κΈ°μ§€λ„ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κ²½μμ •λ³΄ν•™κ³Ό">κ²½μμ •λ³΄ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κ²½μν•™κ³Ό">κ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κ²½μ°°ν–‰μ •ν•™κ³Ό">κ²½μ°°ν–‰μ •ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κ΄‘κ³ ν™λ³΄ν•™κ³Ό">κ΄‘κ³ ν™λ³΄ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κµ­μ–΄κµ­λ¬Έν•™κ³Ό">κµ­μ–΄κµ­λ¬Έν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κµ­μ κ΄€κ΄‘κ²½μν•™κ³Ό">κµ­μ κ΄€κ΄‘κ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κΈμµκ²½μν•™κ³Ό">κΈμµκ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=κΈ°κ³„κ³µν•™κ³Ό">κΈ°κ³„κ³µν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ„·</h2>
          <li><a href="department_discussion.html?dept=λ„μ‹κ³µν•™κ³Ό">λ„μ‹κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ””μμΈμ΅°ν•ν•™κ³Ό">λ””μμΈμ΅°ν•ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ””μ§€ν„Έμ½ν…μΈ ν•™κ³Ό">λ””μ§€ν„Έμ½ν…μΈ ν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ„Ή</h2>
          <li><a href="department_discussion.html?dept=λ μ €μ¤ν¬μΈ ν•™κ³Ό">λ μ €μ¤ν¬μΈ ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ΅λ΄‡κ³µν•™κ³Ό">λ΅λ΄‡κ³µν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…</h2>
          <li><a href="department_discussion.html?dept=λ¬Έν—μ •λ³΄ν•™κ³Ό">λ¬Έν—μ •λ³΄ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ¬Όλ¦¬μΉλ£ν•™κ³Ό">λ¬Όλ¦¬μΉλ£ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ―Έλ””μ–΄μ»¤λ®¤λ‹μΌ€μ΄μ…ν•™κ³Ό">λ―Έλ””μ–΄μ»¤λ®¤λ‹μΌ€μ΄μ…ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ―Έλλ¨λΉλ¦¬ν‹°ν•™κ³Ό(μ΅°κΈ°μ·¨μ—…ν•κ³„μ•½ν•™κ³Ό)">λ―Έλλ¨λΉλ¦¬ν‹°ν•™κ³Ό(μ΅°κΈ°μ·¨μ—…ν•κ³„μ•½ν•™κ³Ό)</a></li>
          <li><a href="department_discussion.html?dept=λ¬΄μ—­ν•™κ³Ό">λ¬΄μ—­ν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…‚</h2>
          <li><a href="department_discussion.html?dept=λ°©μ‚¬μ„ ν•™κ³Ό">λ°©μ‚¬μ„ ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ²•ν•™κ³Ό">λ²•ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=λ¶€λ™μ‚°μμ‚°κ²½μν•™λ¶€">λ¶€λ™μ‚°μμ‚°κ²½μν•™λ¶€</a></li>
        </div>
        <div class="departments2">
          <h2>γ……</h2>
          <li><a href="department_discussion.html?dept=μ‚°μ—…κ²½μλΉ…λ°μ΄ν„°κ³µν•™κ³Ό">μ‚°μ—…κ²½μλΉ…λ°μ΄ν„°κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ‚¬νλ³µμ§€ν•™κ³Ό">μ‚¬νλ³µμ§€ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ†λ°©λ°©μ¬ν–‰μ •ν•™κ³Ό">μ†λ°©λ°©μ¬ν–‰μ •ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ†ν”„νΈμ›¨μ–΄μµν•©λ€ν•™">μ†ν”„νΈμ›¨μ–΄μµν•©λ€ν•™</a></li>
          <li><a href="department_discussion.html?dept=μ†ν”„νΈμ›¨μ–΄μµν•©ν•™κ³Ό(μ΅°κΈ°μ·¨μ—…ν•κ³„μ•½ν•™κ³Ό)">μ†ν”„νΈμ›¨μ–΄μµν•©ν•™κ³Ό(μ΅°κΈ°μ·¨μ—…ν•κ³„μ•½ν•™κ³Ό)</a></li>
          <li><a href="department_discussion.html?dept=μ¤λ§νΈνΈμ¤ν”Όνƒλ¦¬ν‹°ν•™κ³Ό(μ΅°κΈ°μ·¨μ—…ν•κ³„μ•½ν•™κ³Ό)">μ¤λ§νΈνΈμ¤ν”Όνƒλ¦¬ν‹°ν•™κ³Ό(μ΅°κΈ°μ·¨μ—…ν•κ³„μ•½ν•™κ³Ό)</a></li>
          <li><a href="department_discussion.html?dept=μ¤λ§νΈν•­λ§λ¬Όλ¥ν•™κ³Ό">μ¤λ§νΈν•­λ§λ¬Όλ¥ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ‹¬λ¦¬ν•™κ³Ό">μ‹¬λ¦¬ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ‹ν’κ³µν•™κ³Ό">μ‹ν’κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ‹ν’μμ–‘ν•™κ³Ό">μ‹ν’μμ–‘ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ‹ μ†μ¬κ³µν•™κ³Ό">μ‹ μ†μ¬κ³µν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…‡</h2>
          <li><a href="department_discussion.html?dept=μ•„λ™ν•™κ³Ό">μ•„λ™ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ•μ „κ³µν•™κ³Ό">μ•μ „κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ™Έμ‹κ²½μν•™κ³Ό">μ™Έμ‹κ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μμ–΄μλ¬Έν•™κ³Ό">μμ–΄μλ¬Έν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μν™”ν•™κ³Ό">μν™”ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ μ•„κµμ΅κ³Ό">μ μ•„κµμ΅κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ ν†µλ¬Όλ¥ν•™κ³Ό">μ ν†µλ¬Όλ¥ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μμ•…ν•™κ³Ό">μμ•…ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ‘μ©μ†ν”„νΈμ›¨μ–΄κ³µν•™κ³Ό">μ‘μ©μ†ν”„νΈμ›¨μ–΄κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μΈκ³µμ§€λ¥ν•™κ³Ό">μΈκ³µμ§€λ¥ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μΈκ°„κ³µν•™κ³Ό">μΈκ°„κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μλ£κ²½μν•™κ³Ό">μλ£κ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μμƒλ…κ³µν•™κ³Ό">μμƒλ…κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ„μƒλ³‘λ¦¬ν•™κ³Ό">μ„μƒλ³‘λ¦¬ν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…</h2>
          <li><a href="department_discussion.html?dept=μλ™μ°¨κ³µν•™κ³Ό">μλ™μ°¨κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ¬λ¬΄λ¶€λ™μ‚°ν•™κ³Ό">μ¬λ¬΄λ¶€λ™μ‚°ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ „κΈ°κ³µν•™κ³Ό">μ „κΈ°κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ „μκ³µν•™κ³Ό">μ „μκ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ ν’λ””μμΈκ³µν•™κ³Ό">μ ν’λ””μμΈκ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ΅°μ„ ν•΄μ–‘κ³µν•™κ³Ό">μ΅°μ„ ν•΄μ–‘κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μλ™μ°¨κ³µν•™κ³Ό">μλ™μ°¨κ³µν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…</h2>
          <li><a href="department_discussion.html?dept=μ°½μ—…ν¬μκ²½μν•™κ³Ό">μ°½μ—…ν¬μκ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ²΄μ΅ν•™κ³Ό">μ²΄μ΅ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μΉμ„μƒν•™κ³Ό">μΉμ„μƒν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…‹</h2>
          <li><a href="department_discussion.html?dept=μ»΄ν“¨ν„°κ³µν•™κ³Ό">μ»΄ν“¨ν„°κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=μ»΄ν“¨ν„°μ†ν”„νΈμ›¨μ–΄κ³µν•™κ³Ό">μ»΄ν“¨ν„°μ†ν”„νΈμ›¨μ–΄κ³µν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…</h2>
          <li><a href="department_discussion.html?dept=νƒκ¶λ„ν•™κ³Ό">νƒκ¶λ„ν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=ν† λ©κ³µν•™κ³Ό">ν† λ©κ³µν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…</h2>
          <li><a href="department_discussion.html?dept=ν¨μ…λ””μμΈν•™κ³Ό">ν¨μ…λ””μμΈν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=ν‰μƒκµμ΅Β·μ²­μ†λ…„μƒλ‹΄ν•™κ³Ό">ν‰μƒκµμ΅Β·μ²­μ†λ…„μƒλ‹΄ν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>γ…</h2>
          <li><a href="department_discussion.html?dept=ν•μμκ³Ό">ν•μμκ³Ό</a></li>
          <li><a href="department_discussion.html?dept=νΈν…”Β·μ»¨λ²¤μ…κ²½μν•™κ³Ό">νΈν…”Β·μ»¨λ²¤μ…κ²½μν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=ν™κ²½κ³µν•™κ³Ό">ν™κ²½κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=ν™”μ¥ν’κ³µν•™κ³Ό">ν™”μ¥ν’κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=ν™”ν•™κ³µν•™κ³Ό">ν™”ν•™κ³µν•™κ³Ό</a></li>
          <li><a href="department_discussion.html?dept=νκ³„ν•™κ³Ό">νκ³„ν•™κ³Ό</a></li>
        </div>
        <div class="departments2"></div>
        <h2>E</h2>
        <li><a href="department_discussion.html?dept=eλΉ„μ¦λ‹μ¤ν•™κ³Ό">eλΉ„μ¦λ‹μ¤ν•™κ³Ό</a></li>
        </div>
        <div class="departments2">
          <h2>K</h2>
          <li><a href="department_discussion.html?dept=K-λ·°ν‹°ν•™κ³Ό">K-λ·°ν‹°ν•™κ³Ό</a></li>
      </ul>
    </section>
  </main>

  <footer class="main-footer">
    <p>&copy; 2024 λ™μλ€ν•™κµ ν•™κ³Όν† λ΅ λ°©. All rights reserved.</p>
  </footer>

<script type="module">
  import { db } from "/firebase-init.js";
  import { ref, get } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";

  async function loadPopularPosts() {
    try {
      const postsRef = ref(db, "posts");
      const snapshot = await get(postsRef);

      if (snapshot.exists()) {
        const posts = snapshot.val();
        const popularPosts = [];

        Object.entries(posts).forEach(([department, departmentPosts]) => {
          Object.entries(departmentPosts).forEach(([postId, post]) => {
            if (post.likes >= 10) {
              popularPosts.push({
                department,      
                postId,         
                title: post.title, 
                likes: post.likes, 
              });
            }
          });
        });
        const sortedPopularPosts = popularPosts
          .sort((a, b) => b.likes - a.likes)
          .slice(0, 5);

        renderPopularPosts(sortedPopularPosts);
      } else {
        renderPopularPosts([]);
      }
    } catch (error) {
      console.error("Error loading popular posts:", error);
    }
  }

  function renderPopularPosts(posts) {
    const list = document.getElementById("popular-posts-list");
    list.innerHTML = posts.length
      ? posts
          .map(
            (post, index) => `
              <li>
                <!-- κ²μ‹κΈ€ λ§ν¬ μƒμ„± -->
                <a href="post_detail.html?dept=${post.department}&id=${post.postId}" style="font-size:18px">
                  <!-- μμ„, ν•™κ³Όλ…, μ¶”μ² μ λ° μ λ© ν‘μ‹ -->
                  <b>
                    <span style='color:black'>${index + 1}. 
                    <span style='color:#004d99'>[${post.department}]</span>
                    <span style="color:red; font-size:13px;">(μ¶”μ²: ${post.likes})</span> 
                    ${post.title}
                    </span>
                  </b>
                </a>
              </li>
            `
          )
          .join("")
      : "<li>μΈκΈ°κΈ€μ΄ μ—†μµλ‹λ‹¤.</li>";
  }
  document.addEventListener("DOMContentLoaded", loadPopularPosts);
  document.getElementById("view-more-popular").addEventListener("click", () => {
    window.location.href = "popular_posts.html";
  });
</script>
</body>
</html>